Trace Begin Qlik Sense Script Paths Include File;
//**************************************************************************************************
//ScriptPaths.txt
//
//Created by: Chris Cammers (Solve)
//Create Date: 2/3/2012
//Description
//	Script paths contain paths needed to connect to common file locations accross the network
//
//Modified	Developer			Description
//02/28/2019      Chris Cammers(Solve)  Adding to Qlik data warehousing samples, making generic
//**************************************************************************************************/
//The variable vDataLib is set in the load script prior to the call for this script file

Let envServerDir =  'lib://$(vDataLib)/';
Let envIsDev = wildMatch('$(vDataLib)','*Development*');

Let envData = '$(envServerDir)' & 'Data\';


Let envExternalData = '$(envData)' & 'External Data\';
Let envTransformedData = '$(envData)' & 'Transformed\';
Let envLoadScripts = '$(envData)' & 'Load Scripts\';
Let envRawData = '$(envData)' & 'Raw\';


/*Global Procedures

*/

sub ConnectDatabase(subServer,subDefaultCatalog,subUserName,subPassword)
    //user name and password are no longer needed because they are stored as part of the library definition.

    If len(Trim('$(subServer)'))>0 then
      Lib Connect to '$(subServer)';
      If len(Trim('$(subDefaultCatalog)'))>0 then
         sql use [$(subDefaultCatalog)];
      end if
    end if	
   //let subServer = Null();
   //let subDefaultCatalog = Null();
   //Let subUserName = Null();
   //Let subPassword = Null();
end Sub


Sub ExecuteEDXTrigger(subTaskName,subIsDev)

   switch subIsDev
      case 1 //Development
         switch subTaskName
            case 'Productivity'
               Execute D:\QlikRepositoryShare\Software\QMSEDX\QMSEDX_CommandLine\qmsedx.exe -task="DevelopmentApplications/Productivity/Productivity.qvw" -qms=http://wbc-qv-01.wbc.local:4799/qms/service -password=RunThisThing;
            case 'SalesToolkit'
               Execute D:\QlikRepositoryShare\Software\QMSEDX\QMSEDX_CommandLine\qmsedx.exe -task="Development Data Models/Sales Tool Kit Data Model.qvw" -qms=http://wbc-qv-01.wbc.local:4799/qms/service -password=RunThisThing;
         end switch
      case 0
         switch subTaskName
            case 'Productivity'
               Execute D:\QlikRepositoryShare\Software\QMSEDX\QMSEDX_CommandLine\qmsedx.exe -task="Productivity/Productivity.qvw" -qms=http://wbc-qv-01.wbc.local:4799/qms/service -password=RunThisThing;
            case 'SalesToolkit'
               Execute D:\QlikRepositoryShare\Software\QMSEDX\QMSEDX_CommandLine\qmsedx.exe -task="Production Data Models/Sales Tool Kit Data Model.qvw" -qms=http://wbc-qv-01.wbc.local:4799/qms/service -password=RunThisThing;
         end switch
   End switch



End sub